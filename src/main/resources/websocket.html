<html>
<head><title>WSS</title></head>
<body>
<script>
    if (window.WebSocket) {
        var socket = new WebSocket('ws://' + location.host + '/ws')
        socket.onmessage = function(message) {
        	var event = JSON.parse(message.data)
        	var uuid = event['Unique-ID']
            console.log(event)
            if (event['Event-Name'] == 'CHANNEL_PARK')
            	socket.send('api uuid_answer '+uuid)
            else if (event['Event-Name'] == 'CHANNEL_ANSWER')
            	socket.send('api uuid_broadcast '+uuid+' playback::/usr/share/freeswitch/sounds/ru/RU/elena/ivr/8000/ivr-welcome.wav')
            else if (event['Event-Name'] == 'PLAYBACK_STOP')
                socket.send('api uuid_kill '+uuid+' CALL_REJECTED')
        }
        socket.onopen = function() {
            console.log('websocket opened')
            socket.send('event text CHANNEL_PARK CHANNEL_ANSWER PLAYBACK_START PLAYBACK_STOP CHANNEL_HANGUP CHANNEL_HANGUP_COMPLETE')
        }
        socket.onclose = function() {
            console.log('websocket closed')
        }
    } else {
        console.log('Your browser does not support websockets')
    }
</script>
</body>
</html>