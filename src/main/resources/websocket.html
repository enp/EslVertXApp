<html>
<head><title>WSS</title></head>
<body>
<script>
if (window.WebSocket) {
	window.onload = function() {
	    socketOpen.onclick = function() {
	    	socket = new WebSocket('ws://' + location.host + '/ws/' + msisdn.value)
	        socket.onopen = function() {
	            console.log('websocket '+socket.url+' opened')
	        }
	        socket.onmessage = function(message) {
	            var event = JSON.parse(message.data)
	            var uuid = event['Unique-ID']
	            console.log(event)
	            switch (event['Event-Name']) {
	            	case 'CHANNEL_PARK':
	            		socket.send(JSON.stringify({ uuid : uuid, action : 'answer' }))
	            		break
	            	case 'CHANNEL_ANSWER':
	            		socket.send(JSON.stringify({ uuid : uuid, action : 'playback', file : 'welcome.wav' }))
	            		break
	            	case 'PLAYBACK_STOP':
	            		if (!event['Conference-Name'])
	            			socket.send(JSON.stringify({ uuid : uuid, action : 'hangup' }))
	            		break
	            }
	        }
	        socket.onclose = function() {
	            console.log('websocket '+socket.url+' closed')
	        }
	    }
	    executeCall.onclick = function() {
	    	socket.send(JSON.stringify({ action : 'call', destination: destination.value }))
	    }
	    executeConference.onclick = function() {
	    	socket.send(JSON.stringify({ action : 'conference', destination: destination.value }))
	    }
	    socketClose.onclick = function() {
	    	socket.close()
	    }
	}    
} else {
    console.log('Your browser does not support websockets')
}
</script>
<input id='msisdn'>
<button id='socketOpen'>Open</button>
<button id='socketClose'>Close</button>
<br><br>
<input id='destination'>
<button id='executeCall'>Call</button>
<button id='executeConference'>Conference</button>
</body>
</html>